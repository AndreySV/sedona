<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<!--

  Copyright (c) 2008 Tridium, Inc
  Licensed under the Academic Free License version 3.0

  History:
    2 Jun 08  Brian Frank  Creation

-->

<!-- TOC-HEADER-START -->
<!-- Auto-generated by sedonac -->
<head>
  <title>Memory</title>
  <meta http-equiv='Content-type' content='text/html;charset=UTF-8' />
  <link rel='stylesheet' type='text/css' href='style.css'/>
</head>
<body>
<p>
  <a href='index.html'>
    <img src='logo.png' alt='Sedona'/>
  </a>
</p>
<div class='nav'>
  <a href='index.html'>Index</a>
 | <a href='arrays.html'>Prev</a>
 | <a href='nativeMethods.html'>Next</a>
</div>
<h1 class='title'>Memory</h1>
<div class='content'>
<!-- TOC-HEADER-END -->

<!--/////////////////////////////////////////////////////////-->
<h1 id="overview">Overview</h1>
<!--/////////////////////////////////////////////////////////-->

<p>
TODO:
  - memory layout (scode, stack, etc)
  - field layout 
  - static inline chaining
  - component/link add/del
</p>

<!--/////////////////////////////////////////////////////////-->
<h1 id="hibernation">Hibernation</h1>
<!--/////////////////////////////////////////////////////////-->

<p>
Sedona supports <i>hibernation</i> which allows a device to enter
a low power state.  Duration hibernation the Sedona's data section
in RAM (managed by the heap <code>malloc</code> and  <code>free</code> 
calls) must be maintained exactly.  The device can either maintain RAM 
during hibernation or save and restore to the same memory addresses.
</p>

<p>
To enter the hibernation state, an application calls <code>Sys.hibernate()</code>.
This will gracefully unwind the Sedona call stack and exit the VM with the
error code <code>ERR_HIBERNATE</code>.  The device's boot code should then
put the device to sleep.  It is a device dependent issue to decide how you
wake up from hibernation.  When the device does wake it up it should restart
the VM with a call to <code>vmUnhibernate(SedonaVM*)</code>.  If your device
doesn't support hibernation, then copy the code in "main.c" to just simulate
hibernation:
</p>

<pre>
result = vmRun(&amp;vm);
while (result == ERR_HIBERNATE)
{
  printf("-- Simulated hibernate --\n");
  result = vmUnhibernate(&amp;vm);
}
</pre>  

<p>
If you are developing Sedona components, applications, or drivers you should
keep hibernation in mind. Any software which might run on a battery powered 
device needs to support hibernation cleanly. This means that function blocks 
should assume the scan rate might have hibernation pauses. If you have 
services which need to do something special, then override: 
<code>Service.onHibernate()</code> and <code>Service.onUnhibernate()</code>.
</p>

<!-- TOC-FOOTER-START -->
<!-- Auto-generated by sedonac -->
</div>
<div class='nav'>
  <a href='index.html'>Index</a>
 | <a href='arrays.html'>Prev</a>
 | <a href='nativeMethods.html'>Next</a>
</div>
<div class='copyright'>Copyright &#169; 2007-2009 Tridium, Inc.</div>
</body>
<!-- TOC-FOOTER-END -->

</html>







